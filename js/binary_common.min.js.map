{"version":3,"sources":["webpack:///./src/javascript/_common/base/socket_cache.js","webpack:///./src/javascript/_common/string_util.js","webpack:///./src/javascript/_common/base/gtm.js","webpack:///./src/javascript/_common/base/currency_base.js","webpack:///./src/javascript/_common/storage.js","webpack:///./src/javascript/_common/url.js","webpack:///./src/javascript/_common/localize.js","webpack:///./src/javascript/_common/check_new_release.js","webpack:///./src/javascript/_common/lib/polyfills/element.matches.js","webpack:///./src/javascript/_common/base/network_monitor_base.js","webpack:///./src/javascript/_common/base/subscription_manager.js","webpack:///./src/javascript/_common/os_detect.js","webpack:///./src/javascript/_common/language.js","webpack:///./src/javascript/_common/base/socket_base.js","webpack:///./src/javascript/_common/base/client_base.js","webpack:///./src/javascript/_common/base/server_time.js","webpack:///./src/javascript/_common/utility.js","webpack:///./src/javascript/_common/base/login.js","webpack:///./src/javascript/_common/common_functions.js"],"names":["moment","require","getLanguage","get","LocalStore","getPropertyValue","getStaticHash","isEmptyObject","SocketCache","config","payout_currencies","expire","active_symbols","map_to","contracts_for","exchange_rates","data_obj","isEmptyValue","data","is_empty_data","Array","isArray","length","response_data","_typeof","Object","keys","request","msg_type","response","getObject","static_hash","clear","key","makeKey","response_obj","isBefore","expires","value","remove","source_obj","arguments","undefined","find","type","forEach","map_key","should_match_all","data_key","indexOf","setObject","set","cached_response","echo_req","cached_message","new_message","has_error_or_missing","error","has_new_value","has_old_cache","has_valid_cache","window","location","reload","add","valueOf","module","exports","padLeft","txt","len","char","text","String","join","numberToString","n","toTitleCase","str","replace","charAt","toUpperCase","substr","toLowerCase","compareBigUnsignedInt","a","b","first_num","second_num","max_length","Math","max","order","Cookies","ClientBase","Login","ServerTime","BinarySocket","getElementById","isVisible","State","getAppId","GTM","isGtmApplicable","test","pushDataLayer","isLoginPages","dataLayer","push","_extends","country_ip","getResponse","language","pageTitle","pjax","url","document","URL","isLoggedIn","visitorId","bom_email","theme","is_dark_mode_on","t","exec","title","eventHandler","get_settings","login_event","localStorage","getItem","is_new_account","removeItem","affiliate_token","getJSON","bom_affiliate_token","moment_now","time","utc","bom_account_type","getAccountType","bom_currency","bom_country","country","bom_country_abbrev","country_code","email","href","bom_today","unix","event","bom_date_joined","bom_age","diff","date_of_birth","bom_firstname","first_name","bom_lastname","last_name","bom_phone","phone","wait","then","mt5_login_list","obj","acc_type","getMT5AccountType","group","login","send","statement","limit","last_transaction_timestamp","bom_transaction_in_last_30d","isAfter","subtract","pushPurchaseData","buy","req","passthrough","bom_ui","bom_symbol","symbol","bom_market","currency","bom_contract_type","contract_type","bom_contract_id","contract_id","bom_transaction_id","transaction_id","bom_buy_price","buy_price","bom_payout","payout","assign","bom_amount","amount","bom_basis","basis","bom_expiry_type","bom_duration","duration","bom_duration_unit","duration_unit","bom_barrier","barrier","bom_barrier_high","bom_barrier_low","barrier2","bom_prediction","pushTransactionData","extra_data","transaction","action","includes","gtm_transactions","JSON","parse","prototype","hasOwnProperty","call","timestamp","transactions_arr","transactions","id","transaction_time","balance","setItem","stringify","mt5NewAccount","mt5_new_account","mt5_account_type","account_type","gtm_data","mt5_last_signup","getAccountOfType","loginid","setLoginFlag","event_name","localize","currencies_config","formatCurrency","addComma","num","decimal_points","is_crypto","number","toFixed","parseFloat","toString","$0","$1","$2","getDecimalPlaces","isCryptocurrency","calcDecimalPlaces","CryptoConfig","crypto_config","BTC","name","min_withdrawal","pa_max_withdrawal","pa_min_withdrawal","BCH","ETH","ETC","LTC","UST","USB","getMinWithdrawal","formatMoney","currency_value","exclude_currency","decimals","minimumFractionDigits","money","sign","Number","decimal_places","isNaN","abs","Intl","options","maximumFractionDigits","NumberFormat","format","setCurrencies","website_status","getCurrencyName","getTransferLimits","which","transfer_limits","min","getTransferFee","currency_from","currency_to","transfer_fee","getMinimumTransferFee","pow","getTextFormat","getMinPayout","getPaWithdrawalLimit","getCurrencies","isProduction","this","Storage","isStorageSupported","storage","e","Store","InScriptStore","object","store","k","slice","_this","_len","_key","has","pathname","path","split","concat","CookieStorage","cookie_name","cookie_domain","hostname","initialized","domain","Date","read","cookie_value","write","val","expireDate","isSecure","secure","SessionStore","sessionStorage","removeCookies","_len2","cookie_names","_key2","domains","parent_path","c","RegExp","cookie","urlForLanguage","urlFor","urlLang","getCurrentProductionDomain","Url","location_url","static_host","paramsHash","param_hash","arr_params","parsed","search","p_l","param","params","host_map","bot.binary.com","developers.binary.com","academy.binary.com","tech.binary.com","blog.binary.com","reset","pars","should_change_to_legacy","lang","url_lang","substring","new_url","normalizePath","urlForCurrentDomain","current_domain","url_object","urlForStatic","querySelector","getAttribute","websiteUrl","protocol","getHostMap","resetStaticHost","template","Localize","localized_texts","doLocalize","index","map","localizeKeepPlaceholders","_toConsumableArray","Set","match","sort","forLang","texts_json","locale","shouldForceReload","last_reload","checkNewRelease","current_hash","xhttp","XMLHttpRequest","onreadystatechange","readyState","status","latest_hash","responseText","open","random","Element","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","s","ownerDocument","querySelectorAll","i","item","NetworkMonitorBase","_pending_timeouts","StatusConfig","status_config","online","class","tooltip","offline","blinking","pendings","pending_keys","ws_init","ws_request","pending_timeouts","_defineProperty","ws_config","network_status","updateUI","isOnline","navigator","onLine","setStatus","hasReadyState","init","ping","ws_events_map","setPending","clearPendings","message","close","wsEvent","setTimeout","clearTimeout","socket_general_functions","fncUpdateUI","addEventListener","__webpack_require__","_utility","SubscriptionManager","subscriptions","forget_requested","subscription_id","dispatch","sub_id","stream_id","subscription","sub_info","subscribers","fnc","forgetStream","forget","fncCallback","match_values","Error","forgets_list","filter","hasCallbackFunction","hasValues","splice","Promise","all","resolve","request_obj","values_obj","every","addSubscriptionFromRequest","send_request","subscribe_request","subscription_props","is_stream","callback","prop","cloneObject","subscribe","isDeepEqual","forgetAll","msg_types","types_to_forget","sub_ids","forget_all","isMobile","userAgent","Language","all_languages","ACH","EN","DE","ES","FR","ID","IT","PL","PT","RU","TH","VI","ZH_CN","ZH_TW","lang_regex","languageFromUrl","custom_url","current_lang","crowdin_lang","body","classList","getAll","setCookie","trim","PromiseClass","getSocketURL","BinarySocketBase","binary_socket","buffered_sends","req_id","wrong_app_id","is_available","is_disconnect_called","is_connected_before","socket_url","timeouts","promises","no_duplicate_requests","sent_requests","items","waiting_list","promise_obj","this_promises","pr","another_exists","some","clearTimeouts","isReady","states","sendBufferedRequests","req_obj","shift","is_resolved","last_response","promise","forced","WebSocket","onopen","authorize","onOpen","onReconnect","onmessage","msg","this_req_id","onMessage","onclose","onDisconnect","availability","sendBuffered","setOnDisconnect","setOnReconnect","removeOnReconnect","removeOnDisconnect","client_object","current_loginid","getAllAccountsObject","current_client","getAllLoginids","isAccountOfType","only_enabled","this_type","TypesMapConfig","types_map_config","default","financial","gaming","virtual","updateAccountList","account_list","account","excluded_until","param_to_set","value_to_set","canTransferFundsTo","to_loginid","from_currency","to_currency","from_landing_company","to_landing_company","maltainvest","malta","is_from_crypto","is_to_crypto","isValidLoginid","valid_login_ids","hasAccountType","hasCurrencyType","loginids","getAccountTitle","types_map","responseAuthorize","is_virtual","parseInt","landing_company_name","shouldAcceptTnc","website_tnc_version","client_tnc_status","clearAllAccounts","setNewAccount","token","currentLandingCompany","landing_company_response","this_shortcode","landing_company_prop","shortcode","shouldCompleteTax","getBasicUpgradeInfo","upgradeable_landing_companies","can_open_multi","can_upgrade_to","current_landing_company","landing_companies","landing_company","canUpgrade","can_upgrade","getLandingCompanyValue","landing_company_object","real","financial_company","gaming_company","getRiskAssessment","is_high_risk","canTransferFunds","hasSvgAccount","canChangeCurrency","is_current","has_no_mt5","has_account_criteria","count","clock_started","pending","server_time","performance_request_time","get_time_interval","update_time_interval","onTimeUpdated","fncTimeUpdated","requestTime","clearInterval","setInterval","performance","now","timeCounter","start_timestamp","performance_response_time","server_time_at_response","updateTime","time_since_response","clone","timePromise","extend","is_empty","isEqualArray","isEqualObject","arr1","arr2","idx","obj1","obj2","string","content","to_replace","unique","array","findIndex","createElement","tag_name","attributes","el","attr","textContent","html","setAttribute","_classCallCheck","reject","Client","domain_app_ids","loginUrl","server_url","signup_device","date_first_contact","marketing_queries","default_binary_url","redirectToLogin","initOneAll","provider","el_button","removeEventListener","preventDefault","brand","socialLoginUrl","elem","offsetWidth","offsetHeight","id_selector"],"mappings":"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","file":"binary_common.min.js","sourcesContent":["const moment           = require('moment');\nconst getLanguage      = require('../language').get;\nconst LocalStore       = require('../storage').LocalStore;\nconst getPropertyValue = require('../utility').getPropertyValue;\nconst getStaticHash    = require('../utility').getStaticHash;\nconst isEmptyObject    = require('../utility').isEmptyObject;\n\n/*\n * Caches WS responses to reduce delay time and number of requests\n * Stores data in LocalStore which is the first one available in: localStorage, sessionStorage, InScriptStore\n *\n * 1. It caches only the response of those calls which determined in `config`\n * 2. It doesn't cache responses which returned error\n * 3. The value is requested by BinarySocket,\n *    if this returns a value according to the logic here, socket code take it as response\n *    but also triggers an async `send` request, to keep the cache updated for next time\n * 4. Uses client's time to set and check for expiry, as the expire durations are not so long to need a more precise one\n *    (And doesn't worth to wait for the response of time call)\n * 5. Some responses should be cached by a particular value from request (e.g. contracts_for_frxAUDJPY)\n *    so there can be more than one value for a particular call\n * 6. Clears the whole cache regardless their expire time on the following events:\n *    6.1. Client changes: login / logout / switch loginid\n *    6.2. Detect a new release (static hash changed)\n */\nconst SocketCache = (() => {\n    // keys are msg_type\n    // expire: how long to keep the value (in minutes)\n    // map_to: to store different responses of the same key, should be array of:\n    //     string  : the property value from echo_req\n    //     function: return value of the function\n    const config = {\n        payout_currencies: { expire: 10 },\n        active_symbols   : { expire: 10, map_to: ['product_type', 'landing_company', getLanguage] },\n        contracts_for    : { expire: 10, map_to: ['contracts_for', 'product_type', 'currency'] },\n        exchange_rates   : { expire: 60, map_to: ['base_currency'] },\n    };\n\n    const storage_key = 'ws_cache';\n\n    let data_obj = {};\n\n    const set = (response) => {\n        const msg_type = response.msg_type;\n\n        if (!config[msg_type]) return;\n\n        // prevent unwanted page behaviour\n        // if a cached version already exists but it gives an error after being called for updating the cache\n        const cached_response = get(response.echo_req) || {};\n        const cached_message  = cached_response[msg_type];\n        const new_message     = response[msg_type];\n\n        const has_error_or_missing = response.error || !(msg_type in response);\n        const has_new_value        = cached_message && isEmptyValue(cached_message) && !isEmptyValue(new_message);\n        const has_old_cache        = cached_message && isEmptyValue(new_message) && !isEmptyValue(cached_message);\n        const has_valid_cache      = !isEmptyValue(cached_response) && !cached_response.error;\n\n        if ((has_error_or_missing || has_new_value || has_old_cache) && has_valid_cache) {\n            clear();\n            window.location.reload();\n            return;\n        }\n\n        const key      = makeKey(response.echo_req, msg_type);\n        const expires  = moment().add(config[msg_type].expire, 'm').valueOf();\n\n        if (!data_obj.static_hash) {\n            data_obj.static_hash = getStaticHash();\n        }\n\n        data_obj[key] = { value: response, expires };\n        LocalStore.setObject(storage_key, data_obj);\n    };\n\n    const isEmptyValue = (data) => {\n        let is_empty_data = false;\n        if (Array.isArray(data)) {\n            if (!data.length) {\n                is_empty_data = true;\n            }\n        } else if (typeof response_data === 'object') {\n            if (!Object.keys(data).length) {\n                is_empty_data = true;\n            }\n        }\n        return is_empty_data;\n    };\n\n    const get = (request, msg_type) => {\n        let response;\n\n        if (isEmptyObject(data_obj)) {\n            data_obj = LocalStore.getObject(storage_key);\n            if (isEmptyObject(data_obj)) return undefined;\n        }\n\n        if (data_obj.static_hash !== getStaticHash()) { // new release\n            clear();\n        }\n\n        const key          = makeKey(request, msg_type);\n        const response_obj = getPropertyValue(data_obj, key) || {};\n\n        if (moment().isBefore(response_obj.expires)) {\n            response = response_obj.value;\n        } else { // remove if expired\n            remove(key);\n        }\n\n        return response;\n    };\n\n    const makeKey = (source_obj = {}, msg_type = '') => {\n        let key = msg_type || Object.keys(source_obj).find(type => config[type]);\n\n        if (key && !isEmptyObject(source_obj)) {\n            ((config[key] || {}).map_to || []).forEach((map_key) => {\n                const value = typeof map_key === 'function' ? map_key() : source_obj[map_key];\n                key += map_key ? `_${value || ''}` : '';\n            });\n        }\n\n        return key;\n    };\n\n    const remove = (key, should_match_all) => {\n        if (should_match_all) {\n            Object.keys(data_obj).forEach((data_key) => {\n                if (data_key.indexOf(key) !== -1) {\n                    delete data_obj[data_key];\n                }\n            });\n        } else if (key in data_obj) {\n            delete data_obj[key];\n        }\n        LocalStore.setObject(storage_key, data_obj);\n    };\n\n    const clear = () => {\n        LocalStore.remove(storage_key);\n        data_obj = {};\n    };\n\n    return {\n        set,\n        get,\n        remove,\n        clear,\n    };\n})();\n\nmodule.exports = SocketCache;\n","const toTitleCase = str => (\n    (str || '').replace(/\\w[^\\s/\\\\]*/g, txt => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase())\n);\n\nconst padLeft = (txt, len, char) => {\n    const text = String(txt || '');\n    return text.length >= len ? text : `${Array((len - text.length) + 1).join(char)}${text}`;\n};\n\nconst compareBigUnsignedInt = (a, b) => {\n    let first_num  = numberToString(a);\n    let second_num = numberToString(b);\n    if (!first_num || !second_num) {\n        return '';\n    }\n    const max_length = Math.max(first_num.length, second_num.length);\n    first_num        = padLeft(first_num, max_length, '0');\n    second_num       = padLeft(second_num, max_length, '0');\n\n    // lexicographical comparison\n    let order = 0;\n    if (first_num !== second_num) {\n        order = first_num > second_num ? 1 : -1;\n    }\n\n    return order;\n};\n\nconst numberToString = n => (typeof n === 'number' ? String(n) : n);\n\nmodule.exports = {\n    toTitleCase,\n    padLeft,\n    numberToString,\n    compareBigUnsignedInt,\n};\n","const Cookies          = require('js-cookie');\nconst moment           = require('moment');\nconst ClientBase       = require('./client_base');\nconst Login            = require('./login');\nconst ServerTime       = require('./server_time');\nconst BinarySocket     = require('./socket_base');\nconst getElementById   = require('../common_functions').getElementById;\nconst isVisible        = require('../common_functions').isVisible;\nconst getLanguage      = require('../language').get;\nconst LocalStore       = require('../storage').LocalStore;\nconst State            = require('../storage').State;\nconst getPropertyValue = require('../utility').getPropertyValue;\nconst getAppId         = require('../../config').getAppId;\n\nconst GTM = (() => {\n    const isGtmApplicable = () => (/^(16303|16929)$/.test(getAppId()));\n\n    const getCommonVariables = () => ({\n        country_ip: State.getResponse('website_status.clients_country'),\n        language  : getLanguage(),\n        pageTitle : pageTitle(),\n        pjax      : State.get('is_loaded_by_pjax'),\n        url       : document.URL,\n        ...ClientBase.isLoggedIn() && {\n            visitorId: ClientBase.get('loginid'),\n            bom_email: ClientBase.get('email'),\n        },\n        ...('is_dark_mode_on' in LocalStore.getObject('ui_store')) && {\n            theme: LocalStore.getObject('ui_store').is_dark_mode_on ? 'dark' : 'light',\n        },\n    });\n\n    const pushDataLayer = (data) => {\n        if (isGtmApplicable() && !Login.isLoginPages()) {\n            dataLayer.push({\n                ...getCommonVariables(),\n                ...data,\n            });\n        }\n    };\n\n    const pageTitle = () => {\n        const t = /^.+[:-]\\s*(.+)$/.exec(document.title);\n        return t && t[1] ? t[1] : document.title;\n    };\n\n    const eventHandler = (get_settings) => {\n        if (!isGtmApplicable()) return;\n        const login_event       = localStorage.getItem('GTM_login');\n        const is_new_account    = localStorage.getItem('GTM_new_account') === '1';\n\n        localStorage.removeItem('GTM_login');\n        localStorage.removeItem('GTM_new_account');\n\n        const affiliate_token = Cookies.getJSON('affiliate_tracking');\n        if (affiliate_token) {\n            pushDataLayer({ bom_affiliate_token: affiliate_token.t });\n        }\n\n        // Get current time (moment, set by server), else fallback to client time\n        const moment_now = window.time || moment().utc();\n        const data = {\n            visitorId         : ClientBase.get('loginid'),\n            bom_account_type  : ClientBase.getAccountType(),\n            bom_currency      : ClientBase.get('currency'),\n            bom_country       : get_settings.country,\n            bom_country_abbrev: get_settings.country_code,\n            bom_email         : get_settings.email,\n            url               : window.location.href,\n            bom_today         : moment_now.unix(),\n        };\n\n        if (is_new_account) {\n            data.event = 'new_account';\n            data.bom_date_joined = data.bom_today;\n        }\n\n        if (!ClientBase.get('is_virtual')) {\n            data.bom_age       = moment_now.diff(moment.unix(get_settings.date_of_birth).utc(), 'year');\n            data.bom_firstname = get_settings.first_name;\n            data.bom_lastname  = get_settings.last_name;\n            data.bom_phone     = get_settings.phone;\n        }\n\n        if (login_event) {\n            data.event = login_event;\n            BinarySocket.wait('mt5_login_list').then((response) => {\n                (response.mt5_login_list || []).forEach((obj) => {\n                    const acc_type = (ClientBase.getMT5AccountType(obj.group) || '')\n                        .replace('real_vanuatu', 'financial').replace('vanuatu_', '').replace(/costarica|svg/, 'gaming'); // i.e. financial_cent, demo_cent, demo_gaming, real_gaming\n                        // TODO [->svg]\n                    if (acc_type) {\n                        data[`mt5_${acc_type}_id`] = obj.login;\n                    }\n                });\n                pushDataLayer(data);\n            });\n        } else {\n            pushDataLayer(data);\n        }\n\n        // check if there are any transactions in the last 30 days for UX interview selection\n        BinarySocket.send({ statement: 1, limit: 1 }).then((response) => {\n            const last_transaction_timestamp = getPropertyValue(response, ['statement', 'transactions', '0', 'transaction_time']);\n            pushDataLayer({\n                bom_transaction_in_last_30d: !!last_transaction_timestamp && moment(last_transaction_timestamp * 1000).isAfter(ServerTime.get().subtract(30, 'days')),\n            });\n        });\n    };\n\n    const pushPurchaseData = (response) => {\n        if (!isGtmApplicable() || ClientBase.get('is_virtual')) return;\n        const buy = response.buy;\n        if (!buy) return;\n        const req  = response.echo_req.passthrough;\n        const data = {\n            event             : 'buy_contract',\n            bom_ui            : 'legacy',\n            bom_symbol        : req.symbol,\n            bom_market        : getElementById('contract_markets').value,\n            bom_currency      : req.currency,\n            bom_contract_type : req.contract_type,\n            bom_contract_id   : buy.contract_id,\n            bom_transaction_id: buy.transaction_id,\n            bom_buy_price     : buy.buy_price,\n            bom_payout        : buy.payout,\n        };\n        Object.assign(data, {\n            bom_amount     : req.amount,\n            bom_basis      : req.basis,\n            bom_expiry_type: getElementById('expiry_type').value,\n        });\n        if (data.bom_expiry_type === 'duration') {\n            Object.assign(data, {\n                bom_duration     : req.duration,\n                bom_duration_unit: req.duration_unit,\n            });\n        }\n        if (isVisible(getElementById('barrier'))) {\n            data.bom_barrier = req.barrier;\n        } else if (isVisible(getElementById('barrier_high'))) {\n            data.bom_barrier_high = req.barrier;\n            data.bom_barrier_low  = req.barrier2;\n        }\n        if (isVisible(getElementById('prediction'))) {\n            data.bom_prediction = req.barrier;\n        }\n\n        pushDataLayer(data);\n    };\n\n    const mt5NewAccount = (response) => {\n        const acc_type = response.mt5_new_account.mt5_account_type ?\n            `${response.mt5_new_account.account_type}_${response.mt5_new_account.mt5_account_type}` : // financial_cent, demo_cent, ...\n            `${response.mt5_new_account.account_type === 'demo' ? 'demo' : 'real'}_gaming`;           // demo_gaming, real_gaming\n\n        const gtm_data = {\n            event          : 'mt5_new_account',\n            bom_email      : ClientBase.get('email'),\n            bom_country    : State.getResponse('get_settings.country'),\n            mt5_last_signup: acc_type,\n        };\n\n        gtm_data[`mt5_${acc_type}_id`] = response.mt5_new_account.login;\n\n        if (/demo/.test(acc_type) && !ClientBase.get('is_virtual')) {\n            gtm_data.visitorId = ClientBase.getAccountOfType('virtual').loginid;\n        }\n\n        pushDataLayer(gtm_data);\n    };\n\n    // Pushes deposit & withdrawal data from transaction-stream to GTM\n    const pushTransactionData = (response, extra_data = {}) => {\n        if (!isGtmApplicable() || ClientBase.get('is_virtual')) return;\n        if (!response.transaction || !response.transaction.action) return;\n        if (!['deposit', 'withdrawal'].includes(response.transaction.action)) return;\n \n        const moment_now  = window.time || moment().utc();\n        const storage_key = 'GTM_transactions';\n        \n        // Remove values from prev days so localStorage doesn't grow to infinity\n        let gtm_transactions = JSON.parse(localStorage.getItem(storage_key)) || {};\n        if (Object.prototype.hasOwnProperty.call(gtm_transactions, 'timestamp')) {\n            if (moment_now.isAfter(moment.unix(gtm_transactions.timestamp).utc(), 'day')) {\n                localStorage.removeItem(storage_key);\n                gtm_transactions = { timestamp: moment_now.unix() };\n            }\n        }\n        const transactions_arr = gtm_transactions.transactions || [];\n        if (!transactions_arr.includes(response.transaction.transaction_id)) {\n            const data = {\n                event           : 'transaction',\n                bom_account_type: ClientBase.getAccountType(),\n                bom_today       : moment_now.unix(),\n                transaction     : {\n                    id     : response.transaction.transaction_id,\n                    type   : response.transaction.action,\n                    time   : response.transaction.transaction_time,\n                    amount : response.transaction.amount,\n                    balance: response.transaction.balance,\n                },\n            };\n            Object.assign(data, extra_data);\n            pushDataLayer(data);\n\n            transactions_arr.push(response.transaction.transaction_id);\n            gtm_transactions.transactions = transactions_arr;\n            gtm_transactions.timestamp    = gtm_transactions.timestamp || moment_now.unix();\n\n            localStorage.setItem(storage_key, JSON.stringify(gtm_transactions));\n        }\n    };\n\n    return {\n        pushDataLayer,\n        eventHandler,\n        pushPurchaseData,\n        pushTransactionData,\n        mt5NewAccount,\n        setLoginFlag: (event_name) => { if (isGtmApplicable()) localStorage.setItem('GTM_login', event_name); },\n    };\n})();\n\nmodule.exports = GTM;\n","const getLanguage      = require('../language').get;\nconst localize         = require('../localize').localize;\nconst getPropertyValue = require('../utility').getPropertyValue;\n\nlet currencies_config = {};\n\nconst getTextFormat = (number, currency) => `${currency} ${addComma(number, getDecimalPlaces(currency), isCryptocurrency(currency))}`;\n\nconst formatMoney = (currency_value, amount, exclude_currency, decimals = 0, minimumFractionDigits = 0) => {\n    let money = amount;\n    if (money) money = String(money).replace(/,/g, '');\n    const sign           = money && Number(money) < 0 ? '-' : '';\n    const decimal_places = decimals || getDecimalPlaces(currency_value);\n\n    money = isNaN(money) ? 0 : Math.abs(money);\n    if (typeof Intl !== 'undefined') {\n        const options = {\n            minimumFractionDigits: minimumFractionDigits || decimal_places,\n            maximumFractionDigits: decimal_places,\n        };\n        money = new Intl.NumberFormat(getLanguage().toLowerCase().replace('_', '-'), options).format(money);\n    } else {\n        money = addComma(money, decimal_places);\n    }\n\n    return sign + (exclude_currency ? '' : formatCurrency(currency_value)) + money;\n};\n\nconst formatCurrency = currency => `<span class=\"symbols ${(currency || '').toLowerCase()}\"></span>`;\n\nconst addComma = (num, decimal_points, is_crypto) => {\n    let number = String(num || 0).replace(/,/g, '');\n    if (typeof decimal_points !== 'undefined') {\n        number = (+number).toFixed(decimal_points);\n    }\n    if (is_crypto) {\n        number = parseFloat(+number);\n    }\n\n    return number.toString().replace(/(^|[^\\w.])(\\d{4,})/g, ($0, $1, $2) => (\n        $1 + $2.replace(/\\d(?=(?:\\d\\d\\d)+(?!\\d))/g, '$&,')\n    ));\n};\n\nconst calcDecimalPlaces = (currency) => isCryptocurrency(currency) ? 8 : 2;\n\nconst getDecimalPlaces = (currency) => (\n    // need to check currencies_config[currency] exists instead of || in case of 0 value\n    currencies_config[currency] ? getPropertyValue(currencies_config, [currency, 'fractional_digits']) : calcDecimalPlaces(currency)\n);\n\nconst setCurrencies = (website_status) => {\n    currencies_config = website_status.currencies_config;\n};\n\n// (currency in crypto_config) is a back-up in case website_status doesn't include the currency config, in some cases where it's disabled\nconst isCryptocurrency = currency => /crypto/i.test(getPropertyValue(currencies_config, [currency, 'type'])) || (currency in CryptoConfig.get());\n\nconst CryptoConfig = (() => {\n    let crypto_config;\n\n    const initCryptoConfig = () => ({\n        BTC: { name: localize('Bitcoin'),       min_withdrawal: 0.002, pa_max_withdrawal: 5,    pa_min_withdrawal: 0.002 },\n        BCH: { name: localize('Bitcoin Cash'),  min_withdrawal: 0.002, pa_max_withdrawal: 5,    pa_min_withdrawal: 0.002 },\n        ETH: { name: localize('Ether'),         min_withdrawal: 0.002, pa_max_withdrawal: 5,    pa_min_withdrawal: 0.002 },\n        ETC: { name: localize('Ether Classic'), min_withdrawal: 0.002, pa_max_withdrawal: 5,    pa_min_withdrawal: 0.002 },\n        LTC: { name: localize('Litecoin'),      min_withdrawal: 0.002, pa_max_withdrawal: 5,    pa_min_withdrawal: 0.002 },\n        UST: { name: localize('Tether'),        min_withdrawal: 0.02,  pa_max_withdrawal: 2000, pa_min_withdrawal: 10 },\n        USB: { name: localize('Binary Coin'),   min_withdrawal: 0.02,  pa_max_withdrawal: 2000, pa_min_withdrawal: 10 },\n    });\n\n    return {\n        get: () => {\n            if (!crypto_config) {\n                crypto_config = initCryptoConfig();\n            }\n            return crypto_config;\n        },\n    };\n})();\n\nconst getMinWithdrawal = currency => (isCryptocurrency(currency) ? (getPropertyValue(CryptoConfig.get(), [currency, 'min_withdrawal']) || 0.002) : 1);\n\n/**\n * Returns the transfer limits for the account.\n * @param currency\n * @param {string} max|undefined\n * @returns numeric|undefined\n */\nconst getTransferLimits = (currency, which) => {\n    const transfer_limits = getPropertyValue(currencies_config, [currency, 'transfer_between_accounts', 'limits']) || getMinWithdrawal(currency);\n    const decimals        = getDecimalPlaces(currency);\n    if (which === 'max') {\n        return transfer_limits.max ? transfer_limits.max.toFixed(decimals) : undefined;\n    }\n\n    return transfer_limits.min ? transfer_limits.min.toFixed(decimals) : undefined;\n};\n\nconst getTransferFee = (currency_from, currency_to) => {\n    const transfer_fee = getPropertyValue(currencies_config, [currency_from, 'transfer_between_accounts', 'fees', currency_to]);\n    return `${typeof transfer_fee === 'undefined' ? '1' : transfer_fee}%`;\n};\n\n// returns in a string format, e.g. '0.00000001'\nconst getMinimumTransferFee = (currency) => {\n    const decimals = getDecimalPlaces(currency);\n    return `${currency} ${(1 / Math.pow(10, decimals)).toFixed(decimals)}`; // we need toFixed() so that it doesn't display in scientific notation, e.g. 1e-8 for currencies with 8 decimal places\n};\n\n// @param {String} limit = max|min\nconst getPaWithdrawalLimit = (currency, limit) => {\n    if (isCryptocurrency(currency)) {\n        return getPropertyValue(CryptoConfig.get(), [currency, `pa_${limit}_withdrawal`]); // pa_min_withdrawal and pa_max_withdrawal used here\n    }\n    return limit === 'max' ? 2000 : 10; // limits for fiat currency\n};\n\nconst getCurrencyName = currency => getPropertyValue(CryptoConfig.get(), [currency, 'name']) || '';\n\nconst getMinPayout = currency => getPropertyValue(currencies_config, [currency, 'stake_default']);\n\nmodule.exports = {\n    formatMoney,\n    formatCurrency,\n    addComma,\n    getDecimalPlaces,\n    setCurrencies,\n    isCryptocurrency,\n    getCurrencyName,\n    getMinWithdrawal,\n    getTransferLimits,\n    getTransferFee,\n    getMinimumTransferFee,\n    getTextFormat,\n    getMinPayout,\n    getPaWithdrawalLimit,\n    getCurrencies: () => currencies_config,\n};\n","const Cookies          = require('js-cookie');\nconst getPropertyValue = require('./utility').getPropertyValue;\nconst isEmptyObject    = require('./utility').isEmptyObject;\nconst isProduction     = require('../config').isProduction;\n\nconst getObject = function (key) {\n    return JSON.parse(this.getItem(key) || '{}');\n};\n\nconst setObject = function (key, value) {\n    if (value && value instanceof Object) {\n        this.setItem(key, JSON.stringify(value));\n    }\n};\n\nif (typeof Storage !== 'undefined') {\n    Storage.prototype.getObject = getObject;\n    Storage.prototype.setObject = setObject;\n}\n\nconst isStorageSupported = (storage) => {\n    if (typeof storage === 'undefined') {\n        return false;\n    }\n\n    const test_key = 'test';\n    try {\n        storage.setItem(test_key, '1');\n        storage.removeItem(test_key);\n        return true;\n    } catch (e) {\n        return false;\n    }\n};\n\nconst Store = function (storage) {\n    this.storage           = storage;\n    this.storage.getObject = getObject;\n    this.storage.setObject = setObject;\n};\n\nStore.prototype = {\n    get(key) {\n        return this.storage.getItem(key) || undefined;\n    },\n    set(key, value) {\n        if (typeof value !== 'undefined') {\n            this.storage.setItem(key, value);\n        }\n    },\n    getObject(key) {\n        return typeof this.storage.getObject === 'function' // Prevent runtime error in IE\n            ? this.storage.getObject(key)\n            : JSON.parse(this.storage.getItem(key) || '{}');\n    },\n    setObject(key, value) {\n        if (typeof this.storage.setObject === 'function') { // Prevent runtime error in IE\n            this.storage.setObject(key, value);\n        } else {\n            this.storage.setItem(key, JSON.stringify(value));\n        }\n    },\n    remove(key) { this.storage.removeItem(key); },\n    clear()     { this.storage.clear(); },\n};\n\nconst InScriptStore = function (object) {\n    this.store = typeof object !== 'undefined' ? object : {};\n};\n\nInScriptStore.prototype = {\n    get(key) {\n        return getPropertyValue(this.store, key);\n    },\n    set(k, value, obj = this.store) {\n        let key = k;\n        if (!Array.isArray(key)) key = [key];\n        if (key.length > 1) {\n            if (!(key[0] in obj) || isEmptyObject(obj[key[0]])) obj[key[0]] = {};\n            this.set(key.slice(1), value, obj[key[0]]);\n        } else {\n            obj[key[0]] = value;\n        }\n    },\n    getObject(key) {\n        return JSON.parse(this.get(key) || '{}');\n    },\n    setObject(key, value) {\n        this.set(key, JSON.stringify(value));\n    },\n    remove(...keys) {\n        keys.forEach((key) => { delete this.store[key]; });\n    },\n    clear()   { this.store = {}; },\n    has(key)  { return this.get(key) !== undefined; },\n    keys()    { return Object.keys(this.store); },\n    call(key) { if (typeof this.get(key) === 'function') this.get(key)(); },\n};\n\nconst State     = new InScriptStore();\nState.prototype = InScriptStore.prototype;\n/**\n * Shorthand function to get values from response object of State\n *\n * @param {String} pathname\n *     e.g. getResponse('authorize.currency') == get(['response', 'authorize', 'authorize', 'currency'])\n */\nState.prototype.getResponse = function (pathname) {\n    let path = pathname;\n    if (typeof path === 'string') {\n        const keys = path.split('.');\n        path = ['response', keys[0]].concat(keys);\n    }\n    return this.get(path);\n};\nState.set('response', {});\n\nconst CookieStorage = function (cookie_name, cookie_domain) {\n    const hostname = window.location.hostname;\n\n    this.initialized = false;\n    this.cookie_name = cookie_name;\n    this.domain      = cookie_domain || (isProduction() ? `.${hostname.split('.').slice(-2).join('.')}` : hostname);\n    this.path        = '/';\n    this.expires     = new Date('Thu, 1 Jan 2037 12:00:00 GMT');\n    this.value       = {};\n};\n\nCookieStorage.prototype = {\n    read() {\n        const cookie_value = Cookies.get(this.cookie_name);\n        try {\n            this.value = cookie_value ? JSON.parse(cookie_value) : {};\n        } catch (e) {\n            this.value = {};\n        }\n        this.initialized = true;\n    },\n    write(val, expireDate, isSecure) {\n        if (!this.initialized) this.read();\n        this.value = val;\n        if (expireDate) this.expires = expireDate;\n        Cookies.set(this.cookie_name, this.value, {\n            expires: this.expires,\n            path   : this.path,\n            domain : this.domain,\n            secure : !!isSecure,\n        });\n    },\n    get(key) {\n        if (!this.initialized) this.read();\n        return this.value[key];\n    },\n    set(key, val) {\n        if (!this.initialized) this.read();\n        this.value[key] = val;\n        Cookies.set(this.cookie_name, this.value, {\n            expires: new Date(this.expires),\n            path   : this.path,\n            domain : this.domain,\n        });\n    },\n    remove() {\n        Cookies.remove(this.cookie_name, {\n            path  : this.path,\n            domain: this.domain,\n        });\n    },\n};\n\nconst removeCookies = (...cookie_names) => {\n    const domains = [\n        `.${document.domain.split('.').slice(-2).join('.')}`,\n        `.${document.domain}`,\n    ];\n\n    let parent_path = window.location.pathname.split('/', 2)[1];\n    if (parent_path !== '') {\n        parent_path = `/${parent_path}`;\n    }\n\n    cookie_names.forEach((c) => {\n        Cookies.remove(c, { path: '/', domain: domains[0] });\n        Cookies.remove(c, { path: '/', domain: domains[1] });\n        Cookies.remove(c);\n        if (new RegExp(c).test(document.cookie) && parent_path) {\n            Cookies.remove(c, { path: parent_path, domain: domains[0] });\n            Cookies.remove(c, { path: parent_path, domain: domains[1] });\n            Cookies.remove(c, { path: parent_path });\n        }\n    });\n};\n\nlet SessionStore,\n    LocalStore;\n\nif (isStorageSupported(window.localStorage)) {\n    LocalStore = new Store(window.localStorage);\n}\nif (isStorageSupported(window.sessionStorage)) {\n    SessionStore = new Store(window.sessionStorage);\n}\n\nif (!LocalStore) {\n    LocalStore = new InScriptStore();\n}\nif (!SessionStore) {\n    SessionStore = new InScriptStore();\n}\n\nmodule.exports = {\n    isStorageSupported,\n    CookieStorage,\n    removeCookies,\n    State,\n    SessionStore,\n    LocalStore,\n};\n","const urlForLanguage             = require('./language').urlFor;\nconst urlLang                    = require('./language').urlLang;\nconst getCurrentProductionDomain = require('../config').getCurrentProductionDomain;\nrequire('url-polyfill');\n\nconst Url = (() => {\n    let location_url,\n        static_host;\n\n    const reset = () => {\n        location_url = window ? window.location : location_url;\n    };\n\n    const params = (href) => {\n        const arr_params = [];\n        const parsed     = ((href ? new URL(href) : location_url).search || '').substr(1).split('&');\n        let p_l          = parsed.length;\n        while (p_l--) {\n            const param = parsed[p_l].split('=');\n            arr_params.push(param);\n        }\n        return arr_params;\n    };\n\n    const paramsHash = (href) => {\n        const param_hash = {};\n        const arr_params = params(href);\n        let param        = arr_params.length;\n        while (param--) {\n            if (arr_params[param][0]) {\n                param_hash[arr_params[param][0]] = arr_params[param][1] || '';\n            }\n        }\n        return param_hash;\n    };\n\n    const normalizePath = path => (path ? path.replace(/(^\\/|\\/$|[^a-zA-Z0-9-_/])/g, '') : '');\n\n    const urlFor = (path, pars, language, should_change_to_legacy = false) => {\n        const lang = (language || urlLang()).toLowerCase();\n        // url language might differ from passed language, so we will always replace using the url language\n        const url_lang = (language ? urlLang().toLowerCase() : lang);\n        const url = window.location.href;\n        let domain = url.substring(0, url.indexOf(`/${url_lang}/`) + url_lang.length + 2);\n        if (should_change_to_legacy) {\n            if (/localhost|binary\\.sx/.test(domain)) {\n                domain = `https://binary.com/${url_lang}/`;\n            } else {\n                domain = domain.replace(/deriv\\.app/, 'binary\\.com');\n            }\n        }\n        const new_url = `${domain}${(normalizePath(path) || 'home')}.html${(pars ? `?${pars}` : '')}`;\n        // replace old lang with new lang\n        return urlForLanguage(lang, new_url);\n    };\n\n    const default_domain = 'binary.com';\n    const host_map = { // the exceptions regarding updating the URLs\n        'bot.binary.com'       : 'www.binary.bot',\n        'developers.binary.com': 'developers.binary.com', // same, shouldn't change\n        'academy.binary.com'   : 'academy.binary.com',\n        'tech.binary.com'      : 'tech.binary.com',\n        'blog.binary.com'      : 'blog.binary.com',\n    };\n\n    const urlForCurrentDomain = (href) => {\n        const current_domain = getCurrentProductionDomain();\n\n        if (!current_domain) {\n            return href; // don't change when domain is not supported\n        }\n\n        const url_object = new URL(href);\n        if (Object.keys(host_map).includes(url_object.hostname)) {\n            url_object.hostname = host_map[url_object.hostname];\n        } else if (url_object.hostname.indexOf(default_domain) !== -1) {\n            // to keep all non-Binary links unchanged, we use default domain for all Binary links in the codebase (javascript and templates)\n            url_object.hostname = url_object.hostname.replace(new RegExp(`\\\\.${default_domain}`, 'i'), `.${current_domain}`);\n        } else {\n            return href;\n        }\n\n        return url_object.href;\n    };\n\n    const urlForStatic = (path = '') => {\n        if (!static_host || static_host.length === 0) {\n            static_host = document.querySelector('script[src*=\"vendor.min.js\"]');\n            if (static_host) {\n                static_host = static_host.getAttribute('src');\n            }\n\n            if (static_host && static_host.length > 0) {\n                static_host = static_host.substr(0, static_host.indexOf('/js/') + 1);\n            } else {\n                static_host = Url.websiteUrl();\n            }\n        }\n\n        return static_host + path.replace(/(^\\/)/g, '');\n    };\n\n    return {\n        reset,\n        paramsHash,\n        urlFor,\n        urlForCurrentDomain,\n        urlForStatic,\n\n        param          : name => paramsHash()[name],\n        websiteUrl     : () => `${location.protocol}//${location.hostname}/`,\n        getHostMap     : () => host_map,\n        resetStaticHost: () => { static_host = undefined; },\n    };\n})();\n\nmodule.exports = Url;\n","const moment   = require('moment');\nconst template = require('./utility').template;\n\nconst Localize = (() => {\n    let localized_texts;\n\n    const localizeForLang = (lang) => {\n        localized_texts = texts_json[lang.toUpperCase()];\n        moment.locale(lang.toLowerCase());\n    };\n\n    const doLocalize = (txt, params) => {\n        let text = txt;\n\n        const index = text.replace(/[\\s|.]/g, '_');\n\n        text = (localized_texts && localized_texts[index]) || text;\n\n        // only use template when explicitly required\n        return params ? template(text, params) : text;\n    };\n\n    const localize = (text, params) => (\n        Array.isArray(text) ? text.map(t => doLocalize(t, params)) : doLocalize(text, params)\n    );\n\n    /**\n     * Localizes the text, but doesn't replace placeholders\n     * The localized text through this method should replace the placeholders later. e.g. using template()\n     * @param  {String} text - text to be localized\n     * @return {String} the localized text having the original placeholders ([_1], ...)\n     */\n    const localizeKeepPlaceholders = (text) => (\n        localize(\n            text /* localize-ignore */,\n            [...new Set(text.match(/\\[_(\\d+)]/g).sort())]\n        )\n    );\n\n    return {\n        localize,\n        localizeKeepPlaceholders,\n        forLang: localizeForLang,\n    };\n})();\n\nmodule.exports = Localize;\n","const moment        = require('moment');\nconst urlForStatic  = require('./url').urlForStatic;\nconst getStaticHash = require('./utility').getStaticHash;\n\n// only reload if it's more than 10 minutes since the last reload\nconst shouldForceReload = last_reload => !last_reload || +last_reload + (10 * 60 * 1000) < moment().valueOf();\n\n// calling this method is handled by GTM tags\nconst checkNewRelease = () => {\n    const last_reload = localStorage.getItem('new_release_reload_time');\n    if (!shouldForceReload(last_reload)) return false;\n    localStorage.setItem('new_release_reload_time', moment().valueOf());\n\n    const current_hash = getStaticHash();\n    const xhttp        = new XMLHttpRequest();\n\n    xhttp.onreadystatechange = () => {\n        if (+xhttp.readyState === 4 && +xhttp.status === 200) {\n            const latest_hash = xhttp.responseText;\n            if (latest_hash && current_hash && latest_hash !== current_hash) {\n                window.location.reload(true);\n            }\n        }\n    };\n    xhttp.open('GET', urlForStatic(`version?${Math.random().toString(36).slice(2)}`), true);\n    xhttp.send();\n\n    return true;\n};\n\nmodule.exports = {\n    shouldForceReload,\n    checkNewRelease,\n};\n","if (!Element.prototype.matches) {\n    Element.prototype.matches =\n        Element.prototype.matchesSelector ||\n        Element.prototype.mozMatchesSelector ||\n        Element.prototype.msMatchesSelector ||\n        Element.prototype.oMatchesSelector ||\n        Element.prototype.webkitMatchesSelector ||\n        function(s) {\n            var matches = (this.document || this.ownerDocument).querySelectorAll(s),\n                i = matches.length;\n            while (--i >= 0 && matches.item(i) !== this) {}\n            return i > -1;\n        };\n}\n","const BinarySocket = require('./socket_base');\nconst localize     = require('../localize').localize;\n\n/*\n * Monitors the network status and initialises the WebSocket connection\n * 1. online : check the WS status (init/send: blink after timeout, open/message: online)\n * 2. offline: it is offline\n */\nconst NetworkMonitorBase = (() => {\n    const StatusConfig = (() => {\n        let status_config;\n\n        const initStatusConfig = () => ({\n            online  : { class: 'online',  tooltip: localize('Online') },\n            offline : { class: 'offline', tooltip: localize('Offline') },\n            blinking: { class: 'blinker', tooltip: localize('Connecting to server') },\n        });\n\n        return {\n            get: (status) => {\n                if (!status_config) {\n                    status_config = initStatusConfig();\n                }\n                return status_config[status];\n            },\n        };\n    })();\n\n    const pendings = {};\n    const pending_keys = {\n        ws_init   : 'ws_init',\n        ws_request: 'ws_request',\n    };\n    const pending_timeouts = {\n        [pending_keys.ws_init]   : 5000,\n        [pending_keys.ws_request]: 10000,\n    };\n\n    let ws_config,\n        network_status,\n        updateUI;\n\n    const init = (socket_general_functions, fncUpdateUI) => {\n        updateUI  = fncUpdateUI;\n        ws_config = Object.assign({ wsEvent, isOnline }, socket_general_functions);\n\n        if ('onLine' in navigator) {\n            window.addEventListener('online',  setStatus);\n            window.addEventListener('offline', setStatus);\n        } else { // if not supported, default to online and fallback to WS checks\n            navigator.onLine = true;\n        }\n\n        if (isOnline()) {\n            BinarySocket.init(ws_config);\n        }\n\n        setStatus(isOnline() ? 'online' : 'offline');\n    };\n\n    const isOnline = () => navigator.onLine;\n\n    const wsReconnect = () => {\n        if (isOnline() && BinarySocket.hasReadyState(2, 3)) { // CLOSING or CLOSED\n            BinarySocket.init(ws_config);\n        } else {\n            BinarySocket.send({ ping: 1 }); // trigger a request to get stable status sooner\n        }\n    };\n\n    const setStatus = (status) => {\n        if (!isOnline()) {\n            network_status = 'offline';\n        } else if (pending_keys[status] || network_status === 'offline') {\n            network_status = 'blinking';\n            wsReconnect();\n        } else {\n            network_status = 'online';\n        }\n\n        if (typeof updateUI === 'function') {\n            updateUI(StatusConfig.get(network_status), isOnline());\n        }\n    };\n\n    const ws_events_map = {\n        init   : () => setPending(pending_keys.ws_init),\n        open   : () => clearPendings(pending_keys.ws_init),\n        send   : () => setPending(pending_keys.ws_request),\n        message: () => clearPendings(),\n        close  : () => setPending(pending_keys.ws_init),\n    };\n\n    const wsEvent = (event) => {\n        if (typeof ws_events_map[event] === 'function') {\n            ws_events_map[event]();\n        }\n    };\n\n    const setPending = (key) => {\n        if (!pendings[key]) {\n            pendings[key] = setTimeout(() => {\n                pendings[key] = undefined;\n                setStatus(key);\n            }, pending_timeouts[key]);\n        }\n    };\n\n    const clearPendings = (key) => {\n        const clear = (k) => {\n            clearTimeout(pendings[k]);\n            pendings[k] = undefined;\n            if (k === pending_keys.ws_request) {\n                setStatus('online');\n            }\n        };\n\n        if (key) {\n            clear(key);\n        } else {\n            Object.keys(pendings).forEach(clear);\n        }\n    };\n\n    return {\n        init,\n        wsEvent,\n    };\n})();\n\nmodule.exports = NetworkMonitorBase;\n","import BinarySocket   from './socket_base';\nimport {\n    cloneObject,\n    getPropertyValue,\n    isDeepEqual,\n    isEmptyObject }   from '../utility';\n\n/**\n * A layer over BinarySocket to handle subscribing to streaming calls\n * in order to keep track of subscriptions, manage forget, prevent multiple subscription at the same time, ...\n *\n * structure of the the subscription object is:\n * {\n *     1: { msg_type: 'proposal', request: { ... }, stream_id: '...', subscribers: [ ... ] },\n *     2: ...\n * }\n * object keys: subscription_id that assigned to each subscription\n * msg_type   : msg_type of the request for faster filtering\n * request    : the request object, used to subscribe to the same stream when there is a new subscribe request with exactly the same values\n * stream_id  : id of the stream which stored from its response and used to forget the stream when needed\n * subscribers: an array of callbacks to dispatch the response to\n */\nconst SubscriptionManager = (() => {\n    const subscriptions    = {};\n    const forget_requested = {};\n\n    let subscription_id = 0;\n\n    /**\n     * To submit request for a new subscription\n     *\n     * @param {String}   msg_type             msg_type of the request\n     * @param {Object}   request_obj          the whole object of the request to be made\n     * @param {Function} fncCallback          callback function to pass the responses to\n     * @param {Boolean}  should_forget_first  when it's true: forgets the previous subscription, then subscribes after receiving the forget response (if any)\n     */\n    const subscribe = (msg_type, request_obj, fncCallback, should_forget_first = false) => {\n        if (should_forget_first) {\n            forget(msg_type, fncCallback).then(() => {\n                subscribe(msg_type, request_obj, fncCallback);\n            });\n            return;\n        }\n\n        let sub_id = Object.keys(subscriptions).find(id => isDeepEqual(request_obj, subscriptions[id].request));\n\n        if (!sub_id) {\n            sub_id = ++subscription_id;\n\n            subscriptions[sub_id] = {\n                msg_type,\n                request    : cloneObject(request_obj),\n                stream_id  : '',             // stream_id will be updated after receiving the response\n                subscribers: [fncCallback],\n            };\n\n            BinarySocket.send(request_obj, {\n                callback: (response) => dispatch(response, sub_id),\n            });\n        } else if (!hasCallbackFunction(sub_id, fncCallback)) {\n            // there is already an active subscription for the very same request which fncCallback is not subscribed to it yet\n            subscriptions[sub_id].subscribers.push(fncCallback);\n        }\n    };\n\n    /**\n     * Add subscription without subscribers from request\n     * E.g. open subscription to proposal_open_contract on buy request\n     * @param {String}   msg_type               msg_type of the subscription\n     * @param {Object}   send_request           the object of the request to be made\n     * @param {Object}   subscribe_request      the object of the subscription request\n     * @param {Array}    subscription_props     Array of prop strings to add to subscribe_request from initial request, e.g. contract_id\n     */\n    const addSubscriptionFromRequest = (msg_type, send_request, subscribe_request, subscription_props) =>\n        new Promise((resolve) => {\n            let sub_id;\n            let is_stream = false;\n\n            BinarySocket.send(send_request, {\n                callback: (response) => {\n                    if (response.error) {\n                        return resolve(response);\n                    }\n                    if (!is_stream) {\n                        is_stream = true;\n                        sub_id    = ++subscription_id;\n\n                        if (subscription_props && Array.isArray(subscription_props)) {\n                            subscription_props.forEach((prop) => {\n                                if (response[response.msg_type][prop]) {\n                                    subscribe_request[prop] = response[response.msg_type][prop];\n                                }\n                            });\n                        }\n\n                        subscriptions[sub_id] = {\n                            msg_type,\n                            request    : cloneObject(subscribe_request),\n                            stream_id  : '',             // stream_id will be updated after receiving the response\n                            subscribers: [],\n                        };\n                        return resolve(response);\n                    }\n                    return dispatch(response, sub_id);\n                },\n            });\n        });\n\n    // dispatches the response to subscribers of the specific subscription id (internal use only)\n    const dispatch = (response, sub_id) => {\n        const stream_id = getPropertyValue(response, [response.msg_type, 'id']) || getPropertyValue(response.subscription, ['id']);\n\n        if (!subscriptions[sub_id]) {\n            if (!forget_requested[stream_id]) {\n                forgetStream(stream_id);\n            }\n            return;\n        }\n\n        const sub_info = subscriptions[sub_id];\n        // set the stream_id\n        if (!sub_info.stream_id && stream_id) {\n            sub_info.stream_id = stream_id;\n        }\n\n        // callback subscribers\n        const subscribers = sub_info.subscribers;\n        if (subscribers.length) {\n            if (\n                // it is the first response\n                !sub_info.stream_id &&\n                    (\n                        // the first response returned error\n                        response.error\n                        || (\n                            // not a subscription (i.e. subscribed proposal_open_contract for an expired contract)\n                            // also to filter out streams with no stream id but later it will continue streaming (i.e. proposal_open_contract without contract id)\n                            !isEmptyObject(response[response.msg_type]) &&\n                            // check msg_type to filter out those calls which don't return stream `id` on first response (tick_history, ...)\n                            response.msg_type === sub_info.msg_type\n                        )\n                    )\n                ||\n                // remove when response isn't first and response has no stream_id\n                !stream_id && sub_info.stream_id\n            ) {\n                delete subscriptions[sub_id];\n            }\n            sub_info.subscribers.forEach((fnc) => {\n                fnc(response);\n            });\n        } else {\n            delete subscriptions[sub_id];\n            forgetStream(sub_info.stream_id);\n        }\n    };\n\n    /**\n     * To forget a subscription which submitted for a specific callback function\n     *\n     * @param  {String}   msg_type      msg_type to forget\n     * @param  {Function} fncCallback   the same function passed to subscribe()\n     *     (this is the way to distinguish between different subscribers of the same stream at the same time)\n     * @param  {Object}   match_values  optional, to only forget subscriptions having request that \"contains\" provided values\n     * @return {Promise}  the promise object of all possible forget requests\n     */\n    const forget = (msg_type, fncCallback, match_values) => {\n        if (typeof fncCallback !== 'function') {\n            throw new Error(`Missing callback function. To forget all subscriptions of msg_type: ${msg_type}, please call forgetAll().`);\n        }\n\n        // find corresponding id(s)\n        const sub_ids = Object.keys(subscriptions).filter(id => (\n            subscriptions[id].msg_type === msg_type &&\n            hasCallbackFunction(id, fncCallback)\n        ));\n\n        const forgets_list = [];\n        sub_ids.forEach((id) => {\n            if (match_values && !hasValues(subscriptions[id].request, match_values)) {\n                return;\n            }\n            const stream_id = subscriptions[id].stream_id;\n            if (stream_id && subscriptions[id].subscribers.length === 1) {\n                delete subscriptions[id];\n                forgets_list.push(forgetStream(stream_id));\n            } else {\n                // there are other subscribers, or for some reason there is no stream_id:\n                // (i.e. returned an error, or forget() being called before the first response)\n                subscriptions[id].subscribers.splice(subscriptions[id].subscribers.indexOf(fncCallback), 1);\n            }\n        });\n        return Promise.all(forgets_list);\n    };\n\n    /**\n     * To forget all active subscriptions of a list of msg_types\n     *\n     * @param  {String}  msg_types  list of msg_types to forget\n     * @return {Promise} the promise object of all possible forget_all requests\n     */\n    const forgetAll = (...msg_types) => {\n        const types_to_forget = {};\n\n        msg_types.forEach((msg_type) => {\n            const sub_ids = Object.keys(subscriptions).filter(id => subscriptions[id].msg_type === msg_type);\n            if (sub_ids.length) {\n                sub_ids.forEach((id) => {\n                    delete subscriptions[id];\n                });\n                types_to_forget[msg_type] = true;\n            }\n        });\n\n        return Promise.resolve(\n            !isEmptyObject(types_to_forget) ?\n                BinarySocket.send({ forget_all: Object.keys(types_to_forget) }) :\n                {}\n        );\n    };\n\n    const forgetStream = (stream_id) => {\n        forget_requested[stream_id] = true; // to prevent forgetting multiple times\n        return Promise.resolve(\n            stream_id ?\n                BinarySocket.send({ forget: stream_id }).then(() => { delete forget_requested[stream_id]; }) :\n                {}\n        );\n    };\n\n    const hasCallbackFunction = (sub_id, fncCallback) =>\n        (subscriptions[sub_id] && subscriptions[sub_id].subscribers.indexOf(fncCallback) !== -1);\n\n    const hasValues = (request_obj, values_obj) => (\n        typeof request_obj === 'object' &&\n        typeof values_obj  === 'object' &&\n        Object.keys(values_obj).every(key => request_obj[key] === values_obj[key])\n    );\n\n    return {\n        addSubscriptionFromRequest,\n        subscribe,\n        forget,\n        forgetAll,\n    };\n})();\n\nexport default SubscriptionManager;\n","const isMobile = () => /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n\nmodule.exports = {\n    isMobile,\n};\n","const Cookies       = require('js-cookie');\nconst CookieStorage = require('./storage').CookieStorage;\n\nconst Language = (() => {\n    const all_languages = {\n        ACH  : 'Translations',\n        EN   : 'English',\n        DE   : 'Deutsch',\n        ES   : 'Español',\n        FR   : 'Français',\n        ID   : 'Indonesia',\n        IT   : 'Italiano',\n        PL   : 'Polish',\n        PT   : 'Português',\n        RU   : 'Русский',\n        TH   : 'Thai',\n        VI   : 'Tiếng Việt',\n        ZH_CN: '简体中文',\n        ZH_TW: '繁體中文',\n    };\n    const default_language = 'EN';\n\n    const setCookieLanguage = (lang) => {\n        if (!Cookies.get('language') || lang) {\n            const cookie = new CookieStorage('language');\n            cookie.write((lang || getLanguage()).toUpperCase());\n        }\n    };\n\n    let url_lang = null;\n\n    const lang_regex = new RegExp(`^(${Object.keys(all_languages).join('|')})$`, 'i');\n\n    const languageFromUrl = (custom_url) => {\n        if (url_lang && !custom_url) return url_lang;\n        const url_params = (custom_url || window.location.href).split('/').slice(3);\n        const language   = (url_params.find(lang => lang_regex.test(lang)) || '');\n        if (!custom_url) {\n            url_lang = language;\n        }\n        return language;\n    };\n\n    let current_lang = null;\n\n    const getLanguage = () => {\n        if (/ach/i.test(current_lang) || /ach/i.test(languageFromUrl())) {\n            const crowdin_lang_key = 'jipt_language_code_binary-static';\n            const crowdin_lang     = localStorage.getItem(crowdin_lang_key) || Cookies.get(crowdin_lang_key); // selected language for in-context translation\n            if (crowdin_lang) {\n                current_lang = crowdin_lang.toUpperCase().replace('-', '_').toUpperCase();\n                if (document.body) {\n                    document.body.classList.add(current_lang); // set the body class removed by crowdin code\n                }\n            }\n        }\n        current_lang = (current_lang || (languageFromUrl() || Cookies.get('language') || default_language).toUpperCase());\n        return current_lang;\n    };\n\n    const urlForLanguage = (lang, url = window.location.href) =>\n        url.replace(new RegExp(`/${getLanguage()}/`, 'i'), `/${(lang || default_language).trim().toLowerCase()}/`);\n\n    return {\n        getAll   : () => all_languages,\n        setCookie: setCookieLanguage,\n        get      : getLanguage,\n        urlFor   : urlForLanguage,\n        urlLang  : languageFromUrl,\n        reset    : () => { url_lang = null; current_lang = null; },\n    };\n})();\n\nmodule.exports = Language;\n","const ClientBase       = require('./client_base');\nconst SocketCache      = require('./socket_cache');\nconst getLanguage      = require('../language').get;\nconst State            = require('../storage').State;\nconst cloneObject      = require('../utility').cloneObject;\nconst getPropertyValue = require('../utility').getPropertyValue;\nconst isEmptyObject    = require('../utility').isEmptyObject;\nconst PromiseClass     = require('../utility').PromiseClass;\nconst getAppId         = require('../../config').getAppId;\nconst getSocketURL     = require('../../config').getSocketURL;\n\n/*\n * An abstraction layer over native javascript WebSocket,\n * which provides additional functionality like\n * reopen the closed connection and process the buffered requests\n */\nconst BinarySocketBase = (() => {\n    let binary_socket;\n\n    let config               = {};\n    let buffered_sends       = [];\n    let req_id               = 0;\n    let wrong_app_id         = 0;\n    let is_available         = true;\n    let is_disconnect_called = false;\n    let is_connected_before  = false;\n\n    const socket_url = `${getSocketURL()}?app_id=${getAppId()}&l=${getLanguage()}`;\n    const timeouts   = {};\n    const promises   = {};\n\n    const no_duplicate_requests = [\n        'authorize',\n        'get_settings',\n        'residence_list',\n        'landing_company',\n        'payout_currencies',\n        'asset_index',\n    ];\n\n    const sent_requests = {\n        items : [],\n        clear : () => { sent_requests.items = []; },\n        has   : msg_type => sent_requests.items.indexOf(msg_type) >= 0,\n        add   : (msg_type) => { if (!sent_requests.has(msg_type)) sent_requests.items.push(msg_type); },\n        remove: (msg_type) => {\n            if (sent_requests.has(msg_type)) sent_requests.items.splice(sent_requests.items.indexOf(msg_type, 1));\n        },\n    };\n\n    const waiting_list = {\n        items: {},\n        add  : (msg_type, promise_obj) => {\n            if (!waiting_list.items[msg_type]) {\n                waiting_list.items[msg_type] = [];\n            }\n            waiting_list.items[msg_type].push(promise_obj);\n        },\n        resolve: (response) => {\n            const msg_type      = response.msg_type;\n            const this_promises = waiting_list.items[msg_type];\n            if (this_promises && this_promises.length) {\n                this_promises.forEach((pr) => {\n                    if (!waiting_list.another_exists(pr, msg_type)) {\n                        pr.resolve(response);\n                    }\n                });\n                waiting_list.items[msg_type] = [];\n            }\n        },\n        another_exists: (pr, msg_type) => (\n            Object.keys(waiting_list.items)\n                .some(type => (\n                    type !== msg_type &&\n                    waiting_list.items[type].indexOf(pr) !== -1\n                ))\n        ),\n    };\n\n    const clearTimeouts = () => {\n        Object.keys(timeouts).forEach((key) => {\n            clearTimeout(timeouts[key]);\n            delete timeouts[key];\n        });\n    };\n\n    const isReady = () => hasReadyState(1);\n\n    const isClose = () => !binary_socket || hasReadyState(2, 3);\n\n    const hasReadyState = (...states) => binary_socket && states.some(s => binary_socket.readyState === s);\n\n    const sendBufferedRequests = () => {\n        while (buffered_sends.length > 0 && is_available) {\n            const req_obj = buffered_sends.shift();\n            send(req_obj.request, req_obj.options);\n        }\n    };\n\n    const wait = (...msg_types) => {\n        const promise_obj = new PromiseClass();\n        let is_resolved   = true;\n        msg_types.forEach((msg_type) => {\n            const last_response = State.get(['response', msg_type]);\n            if (!last_response) {\n                if (msg_type !== 'authorize' || ClientBase.isLoggedIn()) {\n                    waiting_list.add(msg_type, promise_obj);\n                    is_resolved = false;\n                }\n            } else if (msg_types.length === 1) {\n                promise_obj.resolve(last_response);\n            }\n        });\n        if (is_resolved) {\n            promise_obj.resolve();\n        }\n        return promise_obj.promise;\n    };\n\n    /**\n     * @param {Object} data: request object\n     * @param {Object} options:\n     *      forced  : {boolean}  sends the request regardless the same msg_type has been sent before\n     *      msg_type: {string}   specify the type of request call\n     *      callback: {function} to call on response of streaming requests\n     */\n    const send = function (data, options = {}) {\n        const promise_obj = options.promise || new PromiseClass();\n\n        if (!data || isEmptyObject(data)) return promise_obj.promise;\n\n        const msg_type = options.msg_type || no_duplicate_requests.find(c => c in data);\n\n        // Fetch from cache\n        if (!options.forced) {\n            const response = SocketCache.get(data, msg_type);\n            if (response) {\n                State.set(['response', msg_type], cloneObject(response));\n                if (isReady() && is_available) { // make the request to keep the cache updated\n                    binary_socket.send(JSON.stringify(data), { forced: true });\n                } else if (+data.time !== 1) { // Do not buffer all time requests\n                    buffered_sends.push({\n                        request: data,\n                        options: Object.assign(options, { promise: promise_obj, forced: true }),\n                    });\n                }\n                promise_obj.resolve(response);\n                return promise_obj.promise;\n            }\n        }\n\n        // Fetch from state\n        if (!options.forced && msg_type && no_duplicate_requests.indexOf(msg_type) !== -1) {\n            const last_response = State.get(['response', msg_type]);\n            if (last_response) {\n                promise_obj.resolve(last_response);\n                return promise_obj.promise;\n            } else if (sent_requests.has(msg_type)) {\n                return wait(msg_type).then((response) => {\n                    promise_obj.resolve(response);\n                    return promise_obj.promise;\n                });\n            }\n        }\n\n        if (!data.req_id) {\n            data.req_id = ++req_id;\n        }\n        promises[data.req_id] = {\n            callback: (response) => {\n                if (typeof options.callback === 'function') {\n                    options.callback(response);\n                } else {\n                    promise_obj.resolve(response);\n                }\n            },\n            subscribe: !!data.subscribe,\n        };\n\n        if (isReady() && is_available && config.isOnline()) {\n            is_disconnect_called = false;\n            if (!getPropertyValue(data, 'passthrough') && !getPropertyValue(data, 'verify_email')) {\n                data.passthrough = {};\n            }\n\n            binary_socket.send(JSON.stringify(data));\n            config.wsEvent('send');\n            if (msg_type && !sent_requests.has(msg_type)) {\n                sent_requests.add(msg_type);\n            }\n        } else if (+data.time !== 1) { // Do not buffer all time requests\n            buffered_sends.push({ request: data, options: Object.assign(options, { promise: promise_obj }) });\n        }\n\n        return promise_obj.promise;\n    };\n\n    const init = (options) => {\n        if (wrong_app_id === getAppId()) {\n            return;\n        }\n        if (typeof options === 'object' && config !== options) {\n            config         = options;\n            buffered_sends = [];\n        }\n        clearTimeouts();\n        config.wsEvent('init');\n\n        if (isClose()) {\n            binary_socket = new WebSocket(socket_url);\n            State.set('response', {});\n        }\n\n        binary_socket.onopen = () => {\n            config.wsEvent('open');\n            if (ClientBase.isLoggedIn()) {\n                send({ authorize: ClientBase.get('token') }, { forced: true });\n            } else {\n                sendBufferedRequests();\n            }\n\n            if (typeof config.onOpen === 'function') {\n                config.onOpen(isReady());\n            }\n\n            if (typeof config.onReconnect === 'function' && is_connected_before) {\n                config.onReconnect();\n            }\n\n            if (!is_connected_before) {\n                is_connected_before = true;\n            }\n        };\n\n        binary_socket.onmessage = (msg) => {\n            config.wsEvent('message');\n            const response = msg.data ? JSON.parse(msg.data) : undefined;\n            if (response) {\n                SocketCache.set(response);\n                const msg_type = response.msg_type;\n\n                // store in State\n                if (!getPropertyValue(response, ['echo_req', 'subscribe']) || /balance|website_status/.test(msg_type)) {\n                    State.set(['response', msg_type], cloneObject(response));\n                }\n                // resolve the send promise\n                const this_req_id = response.req_id;\n                const pr          = this_req_id ? promises[this_req_id] : null;\n                if (pr && typeof pr.callback === 'function') {\n                    pr.callback(response);\n                    if (!pr.subscribe) {\n                        delete promises[this_req_id];\n                    }\n                }\n                // resolve the wait promise\n                waiting_list.resolve(response);\n\n                if (getPropertyValue(response, ['error', 'code']) === 'InvalidAppID') {\n                    wrong_app_id = getAppId();\n                }\n\n                if (typeof config.onMessage === 'function') {\n                    config.onMessage(response);\n                }\n            }\n        };\n\n        binary_socket.onclose = () => {\n            sent_requests.clear();\n            clearTimeouts();\n            config.wsEvent('close');\n\n            if (wrong_app_id !== getAppId() && typeof config.onDisconnect === 'function' && !is_disconnect_called) {\n                config.onDisconnect();\n                is_disconnect_called = true;\n            }\n        };\n    };\n\n    const clear = (msg_type) => {\n        buffered_sends = [];\n        if (msg_type) {\n            State.set(['response', msg_type], undefined);\n            sent_requests.remove(msg_type);\n        }\n    };\n\n    const availability = (status) => {\n        if (typeof status !== 'undefined') {\n            is_available = !!status;\n        }\n        return is_available;\n    };\n\n    return {\n        init,\n        wait,\n        send,\n        clear,\n        clearTimeouts,\n        availability,\n        hasReadyState,\n        sendBuffered      : sendBufferedRequests,\n        get               : () => binary_socket,\n        setOnDisconnect   : (onDisconnect) => { config.onDisconnect = onDisconnect; },\n        setOnReconnect    : (onReconnect) => { config.onReconnect = onReconnect; },\n        removeOnReconnect : () => { delete config.onReconnect; },\n        removeOnDisconnect: () => { delete config.onDisconnect; },\n    };\n})();\n\nmodule.exports = BinarySocketBase;\n","const moment           = require('moment');\nconst isCryptocurrency = require('./currency_base').isCryptocurrency;\nconst SocketCache      = require('./socket_cache');\nconst localize         = require('../localize').localize;\nconst LocalStore       = require('../storage').LocalStore;\nconst State            = require('../storage').State;\nconst getPropertyValue = require('../utility').getPropertyValue;\nconst isEmptyObject    = require('../utility').isEmptyObject;\n\nconst ClientBase = (() => {\n    const storage_key = 'client.accounts';\n    let client_object = {};\n    let current_loginid;\n\n    const init = () => {\n        current_loginid = LocalStore.get('active_loginid');\n        client_object   = getAllAccountsObject();\n    };\n\n    const isLoggedIn = () => (\n        !isEmptyObject(getAllAccountsObject()) &&\n        get('loginid') &&\n        get('token')\n    );\n\n    const isValidLoginid = () => {\n        if (!isLoggedIn()) return true;\n        const valid_login_ids = new RegExp('^(MX|MF|VRTC|MLT|CR|FOG)[0-9]+$', 'i');\n        return getAllLoginids().every(loginid => valid_login_ids.test(loginid));\n    };\n\n    /**\n     * Stores the client information in local variable and localStorage\n     *\n     * @param {String} key                 The property name to set\n     * @param {String|Number|Object} value The regarding value\n     * @param {String|null} loginid        The account to set the value for\n     */\n    const set = (key, value, loginid = current_loginid) => {\n        if (key === 'loginid' && value !== current_loginid) {\n            LocalStore.set('active_loginid', value);\n            current_loginid = value;\n        } else {\n            if (!(loginid in client_object)) {\n                client_object[loginid] = {};\n            }\n            client_object[loginid][key] = value;\n            LocalStore.setObject(storage_key, client_object);\n        }\n    };\n\n    /**\n     * Returns the client information\n     *\n     * @param {String|null} key     The property name to return the value from, if missing returns the account object\n     * @param {String|null} loginid The account to return the value from\n     */\n    const get = (key, loginid = current_loginid) => {\n        let value;\n        if (key === 'loginid') {\n            value = loginid || LocalStore.get('active_loginid');\n        } else {\n            const current_client = client_object[loginid] || getAllAccountsObject()[loginid] || client_object;\n\n            value = key ? current_client[key] : current_client;\n        }\n        if (!Array.isArray(value) && (+value === 1 || +value === 0 || value === 'true' || value === 'false')) {\n            value = JSON.parse(value || false);\n        }\n        return value;\n    };\n\n    const getAllAccountsObject = () => LocalStore.getObject(storage_key);\n\n    const getAllLoginids = () => Object.keys(getAllAccountsObject());\n\n    const getAccountType = (loginid = current_loginid) => {\n        let account_type;\n        if (/^VR/.test(loginid))          account_type = 'virtual';\n        else if (/^MF/.test(loginid))     account_type = 'financial';\n        else if (/^MLT|MX/.test(loginid)) account_type = 'gaming';\n        return account_type;\n    };\n\n    const isAccountOfType = (type, loginid = current_loginid, only_enabled = false) => {\n        const this_type   = getAccountType(loginid);\n        return ((\n            (type === 'virtual' && this_type === 'virtual') ||\n            (type === 'real'    && this_type !== 'virtual') ||\n            type === this_type) &&\n            (only_enabled ? !get('is_disabled', loginid) : true));\n    };\n\n    const getAccountOfType = (type, only_enabled) => {\n        const id = getAllLoginids().find(loginid => isAccountOfType(type, loginid, only_enabled));\n        return id ? Object.assign({ loginid: id }, get(null, id)) : {};\n    };\n\n    const hasAccountType = (type, only_enabled) => !isEmptyObject(getAccountOfType(type, only_enabled));\n\n    // only considers currency of real money accounts\n    // @param {String} type = crypto|fiat\n    const hasCurrencyType = (type) => {\n        const loginids = getAllLoginids();\n        if (type === 'crypto') {\n            // find if has crypto currency account\n            return loginids.find(loginid =>\n                !get('is_virtual', loginid) && isCryptocurrency(get('currency', loginid)));\n        }\n        // else find if have fiat currency account\n        return loginids.find(loginid =>\n            !get('is_virtual', loginid) && !isCryptocurrency(get('currency', loginid)));\n    };\n\n    const TypesMapConfig = (() => {\n        let types_map_config;\n\n        const initTypesMap = () => ({\n            default  : localize('Real'),\n            financial: localize('Investment'),\n            gaming   : localize('Gaming'),\n            virtual  : localize('Virtual'),\n        });\n\n        return {\n            get: () => {\n                if (!types_map_config) {\n                    types_map_config = initTypesMap();\n                }\n                return types_map_config;\n            },\n        };\n    })();\n\n    const getAccountTitle = loginid => {\n        const types_map = TypesMapConfig.get();\n        return (types_map[getAccountType(loginid)] || types_map.default);\n    };\n\n    const responseAuthorize = (response) => {\n        const authorize = response.authorize;\n        set('email',      authorize.email);\n        set('currency',   authorize.currency);\n        set('is_virtual', +authorize.is_virtual);\n        set('session_start', parseInt(moment().valueOf() / 1000));\n        set('landing_company_shortcode', authorize.landing_company_name);\n        updateAccountList(authorize.account_list);\n    };\n\n    const updateAccountList = (account_list) => {\n        account_list.forEach((account) => {\n            set('excluded_until', account.excluded_until || '', account.loginid);\n            Object.keys(account).forEach((param) => {\n                const param_to_set = param === 'country' ? 'residence' : param;\n                const value_to_set = typeof account[param] === 'undefined' ? '' : account[param];\n                if (param_to_set !== 'loginid') {\n                    set(param_to_set, value_to_set, account.loginid);\n                }\n            });\n        });\n    };\n\n    const shouldAcceptTnc = () => {\n        if (get('is_virtual')) return false;\n        const website_tnc_version = State.getResponse('website_status.terms_conditions_version');\n        const client_tnc_status   = State.getResponse('get_settings.client_tnc_status');\n        return typeof client_tnc_status !== 'undefined' && client_tnc_status !== website_tnc_version;\n    };\n\n    const clearAllAccounts = () => {\n        current_loginid = undefined;\n        client_object   = {};\n        LocalStore.setObject(storage_key, client_object);\n    };\n\n    const setNewAccount = (options) => {\n        if (!options.email || !options.loginid || !options.token) {\n            return false;\n        }\n\n        SocketCache.clear();\n        localStorage.setItem('GTM_new_account', '1');\n\n        set('token',      options.token,       options.loginid);\n        set('email',      options.email,       options.loginid);\n        set('is_virtual', +options.is_virtual, options.loginid);\n        set('loginid',    options.loginid);\n\n        return true;\n    };\n\n    const currentLandingCompany = () => {\n        const landing_company_response = State.getResponse('landing_company') || {};\n        const this_shortcode           = get('landing_company_shortcode');\n        const landing_company_prop     = Object.keys(landing_company_response).find((key) => (\n            this_shortcode === landing_company_response[key].shortcode\n        ));\n        return landing_company_response[landing_company_prop] || {};\n    };\n\n    const shouldCompleteTax = () => isAccountOfType('financial') &&\n        !/crs_tin_information/.test((State.getResponse('get_account_status') || {}).status);\n\n    // remove manager id or master distinction from group\n    // remove EUR or GBP distinction from group\n    const getMT5AccountType = group => (group ? group.replace('\\\\', '_').replace(/_(\\d+|master|EUR|GBP)/, '') : '');\n\n    const getBasicUpgradeInfo = () => {\n        const upgradeable_landing_companies = State.getResponse('authorize.upgradeable_landing_companies');\n\n        let can_open_multi = false;\n        let type,\n            can_upgrade_to;\n        if ((upgradeable_landing_companies || []).length) {\n            const current_landing_company = get('landing_company_shortcode');\n\n            can_open_multi = upgradeable_landing_companies.indexOf(current_landing_company) !== -1;\n\n            // only show upgrade message to landing companies other than current\n            const canUpgrade = (...landing_companies) => landing_companies.find(landing_company => (\n                landing_company !== current_landing_company &&\n                upgradeable_landing_companies.indexOf(landing_company) !== -1\n            ));\n\n            // TODO [->svg]\n            can_upgrade_to = canUpgrade('costarica', 'svg', 'iom', 'malta', 'maltainvest');\n            if (can_upgrade_to) {\n                type = can_upgrade_to === 'maltainvest' ? 'financial' : 'real';\n            }\n        }\n\n        return {\n            type,\n            can_upgrade: !!can_upgrade_to,\n            can_upgrade_to,\n            can_open_multi,\n        };\n    };\n\n    const getLandingCompanyValue = (loginid, landing_company, key) => {\n        let landing_company_object;\n        if (loginid.financial || isAccountOfType('financial', loginid)) {\n            landing_company_object = getPropertyValue(landing_company, 'financial_company');\n        } else if (loginid.real || isAccountOfType('real', loginid)) {\n            landing_company_object = getPropertyValue(landing_company, 'gaming_company');\n\n            // handle accounts that don't have gaming company\n            if (!landing_company_object) {\n                landing_company_object = getPropertyValue(landing_company, 'financial_company');\n            }\n        } else {\n            const financial_company = (getPropertyValue(landing_company, 'financial_company') || {})[key] || [];\n            const gaming_company    = (getPropertyValue(landing_company, 'gaming_company') || {})[key] || [];\n            landing_company_object  = financial_company.concat(gaming_company);\n            return landing_company_object;\n        }\n        return (landing_company_object || {})[key];\n    };\n\n    const getRiskAssessment = () => {\n        const status       = State.getResponse('get_account_status.status');\n        const is_high_risk = /high/.test(State.getResponse('get_account_status.risk_classification'));\n\n        return (\n            isAccountOfType('financial') ?\n                /(financial_assessment|trading_experience)_not_complete/.test(status) :\n                (is_high_risk && /financial_assessment_not_complete/.test(status))\n        );\n    };\n\n    // API_V3: send a list of accounts the client can transfer to\n    const canTransferFunds = (account) => {\n        if (account) {\n            // this specific account can be used to transfer funds to\n            return canTransferFundsTo(account.loginid);\n        }\n        // at least one account can be used to transfer funds to\n        return Object.keys(client_object).some(loginid => canTransferFundsTo(loginid));\n    };\n\n    const canTransferFundsTo = (to_loginid) => {\n        if (to_loginid === current_loginid || get('is_virtual', to_loginid) || get('is_virtual') ||\n            get('is_disabled', to_loginid)) {\n            return false;\n        }\n        const from_currency = get('currency');\n        const to_currency   = get('currency', to_loginid);\n        if (!from_currency || !to_currency) {\n            return false;\n        }\n        // only transfer to other accounts that have the same currency as current account if one is maltainvest and one is malta\n        if (from_currency === to_currency) {\n            // these landing companies are allowed to transfer funds to each other if they have the same currency\n            const same_cur_allowed = {\n                maltainvest: 'malta',\n                malta      : 'maltainvest',\n            };\n            const from_landing_company = get('landing_company_shortcode');\n            const to_landing_company   = get('landing_company_shortcode', to_loginid);\n            // if same_cur_allowed[from_landing_company] is undefined and to_landing_company is also undefined, it will return true\n            // so we should compare '' === undefined instead\n            return (same_cur_allowed[from_landing_company] || '') === to_landing_company;\n        }\n        // or for other clients if current account is cryptocurrency it should only transfer to fiat currencies and vice versa\n        const is_from_crypto = isCryptocurrency(from_currency);\n        const is_to_crypto   = isCryptocurrency(to_currency);\n        return (is_from_crypto ? !is_to_crypto : is_to_crypto);\n    };\n\n    const hasSvgAccount = () => !!(getAllLoginids().find(loginid => /^CR/.test(loginid)));\n\n    const canChangeCurrency = (statement, mt5_login_list, is_current = true) => {\n        const currency             = get('currency');\n        const has_no_mt5           = mt5_login_list.length === 0;\n        const has_no_transaction   = (statement.count === 0 && statement.transactions.length === 0);\n        const has_account_criteria = has_no_transaction && has_no_mt5;\n\n        // Current API requirements for currently logged-in user successfully changing their account's currency:\n        // 1. User must not have made any transactions\n        // 2. User must not have any MT5 account\n        // 3. Not be a crypto account\n        // 4. Not be a virtual account\n        return is_current ? currency && !get('is_virtual') && has_account_criteria && !isCryptocurrency(currency) : has_account_criteria;\n    };\n\n    return {\n        init,\n        isLoggedIn,\n        isValidLoginid,\n        set,\n        get,\n        getAllLoginids,\n        getAccountType,\n        isAccountOfType,\n        getAccountOfType,\n        hasAccountType,\n        hasCurrencyType,\n        getAccountTitle,\n        responseAuthorize,\n        shouldAcceptTnc,\n        clearAllAccounts,\n        setNewAccount,\n        currentLandingCompany,\n        shouldCompleteTax,\n        getAllAccountsObject,\n        getMT5AccountType,\n        getBasicUpgradeInfo,\n        getLandingCompanyValue,\n        getRiskAssessment,\n        canTransferFunds,\n        hasSvgAccount,\n        canChangeCurrency,\n    };\n})();\n\nmodule.exports = ClientBase;\n","const moment       = require('moment');\nconst BinarySocket = require('./socket_base');\nconst PromiseClass = require('../utility').PromiseClass;\n\nconst ServerTime = (() => {\n    let clock_started = false;\n    const pending = new PromiseClass();\n    let server_time,\n        performance_request_time,\n        get_time_interval,\n        update_time_interval,\n        onTimeUpdated;\n\n    const init = (fncTimeUpdated) => {\n        if (!clock_started) {\n            onTimeUpdated = fncTimeUpdated;\n            requestTime();\n            clearInterval(get_time_interval);\n            get_time_interval = setInterval(requestTime, 30000);\n            clock_started = true;\n        }\n    };\n\n    const requestTime = () => {\n        performance_request_time = performance.now();\n        BinarySocket.send({ time: 1 }).then(timeCounter);\n    };\n\n    const timeCounter = (response) => {\n        if (response.error) return;\n\n        if (!clock_started) {\n            init();\n            return;\n        }\n\n        clearInterval(update_time_interval);\n\n        const start_timestamp = response.time;\n        const performance_response_time = performance.now();\n        const time_taken = performance_response_time - performance_request_time;\n        const server_time_at_response = ((start_timestamp * 1000) + time_taken);\n\n        const updateTime = () => {\n            const time_since_response = performance.now() - performance_response_time;\n            server_time = moment(server_time_at_response + time_since_response).utc();\n\n            if (typeof onTimeUpdated === 'function') {\n                onTimeUpdated();\n            }\n        };\n        updateTime();\n        pending.resolve();\n        update_time_interval = setInterval(updateTime, 1000);\n    };\n\n    const get = () => server_time ? server_time.clone() : undefined;\n\n    return {\n        init,\n        get,\n        timePromise: pending.promise,\n    };\n})();\n\nmodule.exports = ServerTime;\n","const extend = require('extend');\nrequire('./lib/polyfills/element.matches');\n\nconst template = (string, content) => {\n    let to_replace = content;\n    if (content && !Array.isArray(content)) {\n        to_replace = [content];\n    }\n    return string.replace(/\\[_(\\d+)]/g, (s, index) => to_replace[(+index) - 1]);\n};\n\nconst isEmptyObject = (obj) => {\n    let is_empty = true;\n    if (obj && obj instanceof Object) {\n        Object.keys(obj).forEach((key) => {\n            if (Object.prototype.hasOwnProperty.call(obj, key)) is_empty = false;\n        });\n    }\n    return is_empty;\n};\n\nconst cloneObject = obj => (!isEmptyObject(obj) ? extend(true, Array.isArray(obj) ? [] : {}, obj) : obj);\n\nconst isDeepEqual = (a, b) => {\n    if (typeof a !== typeof b) {\n        return false;\n    } else if (Array.isArray(a)) {\n        return isEqualArray(a, b);\n    } else if (a && b && typeof a === 'object') {\n        return isEqualObject(a, b);\n    }\n    // else\n    return a === b;\n};\n\nconst isEqualArray = (arr1, arr2) => (\n    arr1 === arr2 ||\n    (\n        arr1.length === arr2.length &&\n        arr1.every((value, idx) => isDeepEqual(value, arr2[idx]))\n    )\n);\n\nconst isEqualObject = (obj1, obj2) => (\n    obj1 === obj2 ||\n    (\n        Object.keys(obj1).length === Object.keys(obj2).length &&\n        Object.keys(obj1).every(key => isDeepEqual(obj1[key], obj2[key]))\n    )\n);\n\n// Filters out duplicates in an array of objects by key\nconst unique = (array, key) => array.filter((e, idx) =>\n    array.findIndex((a, i) => a[key] ? a[key] === e[key] : i === idx) === idx);\n\nconst getPropertyValue = (obj, k) => {\n    let keys = k;\n    if (!Array.isArray(keys)) keys = [keys];\n    if (!isEmptyObject(obj) && keys[0] in obj && keys && keys.length > 1) {\n        return getPropertyValue(obj[keys[0]], keys.slice(1));\n    }\n    // else return clone of object to avoid overwriting data\n    return obj ? cloneObject(obj[keys[0]]) : undefined;\n};\n\n/**\n * Creates a DOM element and adds any attributes to it.\n *\n * @param {String} tag_name: the tag to create, e.g. 'div', 'a', etc\n * @param {Object} attributes: all the attributes to assign, e.g. { id: '...', class: '...', html: '...', ... }\n * @return the created DOM element\n */\nconst createElement = (tag_name, attributes = {}) => {\n    const el = document.createElement(tag_name);\n    Object.keys(attributes).forEach((attr) => {\n        const value = attributes[attr];\n        if (attr === 'text') {\n            el.textContent = value;\n        } else if (attr === 'html') {\n            el.html(value);\n        } else {\n            el.setAttribute(attr, value);\n        }\n    });\n    return el;\n};\n\nlet static_hash;\nconst getStaticHash = () => {\n    static_hash = static_hash || (document.querySelector('script[src*=\"binary\"]').getAttribute('src') || '').split('?')[1];\n    return static_hash;\n};\n\nclass PromiseClass {\n    constructor() {\n        this.promise = new Promise((resolve, reject) => {\n            this.reject  = reject;\n            this.resolve = resolve;\n        });\n    }\n}\n\nmodule.exports = {\n    template,\n    isEmptyObject,\n    cloneObject,\n    isDeepEqual,\n    unique,\n    getPropertyValue,\n    createElement,\n    getStaticHash,\n    PromiseClass,\n};\n","const Client              = require('./client_base');\nconst getElementById      = require('../common_functions').getElementById;\nconst getLanguage         = require('../language').get;\nconst isMobile            = require('../os_detect').isMobile;\nconst isStorageSupported  = require('../storage').isStorageSupported;\nconst LocalStore          = require('../storage').LocalStore;\nconst urlForCurrentDomain = require('../url').urlForCurrentDomain;\nconst domain_app_ids      = require('../../config').domain_app_ids;\nconst getAppId            = require('../../config').getAppId;\n\nconst Login = (() => {\n    const redirectToLogin = () => {\n        if (!Client.isLoggedIn() && !isLoginPages() && isStorageSupported(sessionStorage)) {\n            sessionStorage.setItem('redirect_url', window.location.href);\n            window.location.href = loginUrl();\n        }\n    };\n\n    const loginUrl = () => {\n        const server_url         = localStorage.getItem('config.server_url');\n        const language           = getLanguage();\n        const signup_device      = LocalStore.get('signup_device') || (isMobile() ? 'mobile' : 'desktop');\n        const date_first_contact = LocalStore.get('date_first_contact');\n        const marketing_queries  = `&signup_device=${signup_device}${date_first_contact ? `&date_first_contact=${date_first_contact}` : ''}`;\n        const default_binary_url = `https://oauth.binary.com/oauth2/authorize?app_id=${getAppId()}&l=${language}${marketing_queries}`;\n\n        return ((server_url && /qa/.test(server_url)) ?\n            `https://${server_url}/oauth2/authorize?app_id=${getAppId()}&l=${language}${marketing_queries}` :\n            getAppId() === domain_app_ids['deriv.app'] ?\n                default_binary_url\n                : urlForCurrentDomain(default_binary_url)\n        );\n    };\n\n    // TODO: update this to handle logging into /app/ url\n    const isLoginPages = () => /logged_inws|redirect/i.test(window.location.pathname);\n\n    const socialLoginUrl = brand => (`${loginUrl()}&social_signup=${brand}`);\n\n    const initOneAll = () => {\n        ['google', 'facebook'].forEach(provider => {\n            const el_button = getElementById(`#button_${provider}`);\n            el_button.removeEventListener('click');\n            el_button.addEventListener('click', (e) => {\n                e.preventDefault();\n                window.location.href = socialLoginUrl(provider);\n            });\n        });\n    };\n\n    return {\n        redirectToLogin,\n        isLoginPages,\n        initOneAll,\n    };\n})();\n\nmodule.exports = Login;\n","const createElement = require('./utility').createElement;\n\n/*\n * function to check if element is visible or not\n *\n */\nconst isVisible = elem => !(!elem || (elem.offsetWidth === 0 && elem.offsetHeight === 0));\n\n/*\n * @param  {String}  id_selector   the selector for the element\n * @param  {Element} parent        optional selector to use for parent, defaults to document\n * @return {Element}               return element if it exists, if it doesn't return a dummy element\n */\nconst getElementById = (id_selector, parent = document) => parent.getElementById(id_selector) || createElement('div');\n\nmodule.exports = {\n    isVisible,\n    getElementById,\n};\n"],"sourceRoot":""}